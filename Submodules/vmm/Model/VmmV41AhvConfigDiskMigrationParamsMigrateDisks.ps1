#
# Nutanix Virtual Machine Management APIs
# Manage the life-cycle of virtual machines hosted on Nutanix
# Version: 4.1.1
# Generated by OpenAPI Generator: https://openapi-generator.tech
#

<#
.SYNOPSIS

No summary available.

.DESCRIPTION

Specifies the VmDisks of a VM for migration and the migration plan for them. If all the disks of a VM need to be migrated to the same storage container, only a single migration plan with only the external ID of the destination storage container is needed.  If the disks are being migrated to different containers, one plan per disk needs to be specified.

.PARAMETER Json

JSON object

.OUTPUTS

VmmV41AhvConfigDiskMigrationParamsMigrateDisks<PSCustomObject>
#>
function ConvertFrom-JsonToVmmV41AhvConfigDiskMigrationParamsMigrateDisks {
    [CmdletBinding()]
    Param (
        [AllowEmptyString()]
        [string]$Json
    )

    Process {
        $match = 0
        $matchType = $null
        $matchInstance = $null

        # try to match VmmV41AhvConfigAllDisksMigrationPlan defined in the oneOf schemas
        try {
            $matchInstance = ConvertFrom-JsonToVmmV41AhvConfigAllDisksMigrationPlan $Json

            foreach($property in $matchInstance.PsObject.Properties) {
                if ($null -ne $property.Value) {
                    $matchType = "VmmV41AhvConfigAllDisksMigrationPlan"
                    $match++
                    break
                }
            }
        } catch {
            # fail to match the schema defined in oneOf, proceed to the next one
            Write-Debug "Failed to match 'VmmV41AhvConfigAllDisksMigrationPlan' defined in oneOf (VmmV41AhvConfigDiskMigrationParamsMigrateDisks). Proceeding to the next one if any."
        }

        # try to match VmmV41AhvConfigMigrationPlans defined in the oneOf schemas
        try {
            $matchInstance = ConvertFrom-JsonToVmmV41AhvConfigMigrationPlans $Json

            foreach($property in $matchInstance.PsObject.Properties) {
                if ($null -ne $property.Value) {
                    $matchType = "VmmV41AhvConfigMigrationPlans"
                    $match++
                    break
                }
            }
        } catch {
            # fail to match the schema defined in oneOf, proceed to the next one
            Write-Debug "Failed to match 'VmmV41AhvConfigMigrationPlans' defined in oneOf (VmmV41AhvConfigDiskMigrationParamsMigrateDisks). Proceeding to the next one if any."
        }

        if ($match -gt 1) {
            throw "Error! The JSON payload matches more than one type defined in oneOf schemas ([VmmV41AhvConfigAllDisksMigrationPlan, VmmV41AhvConfigMigrationPlans]). JSON Payload: $($Json)"
        } elseif ($match -eq 1) {
            return [PSCustomObject]@{
                "ActualType" = ${matchType}
                "ActualInstance" = ${matchInstance}
                "OneOfSchemas" = @("VmmV41AhvConfigAllDisksMigrationPlan", "VmmV41AhvConfigMigrationPlans")
            }
        } else {
            throw "Error! The JSON payload doesn't matches any type defined in oneOf schemas ([VmmV41AhvConfigAllDisksMigrationPlan, VmmV41AhvConfigMigrationPlans]). JSON Payload: $($Json)"
        }
    }
}

